{
  "name": "BotNot: ETH –∞–Ω–∞–ª–∏–∑ 1m/5m/1h ‚Üí —Å–∏–≥–Ω–∞–ª –≤ Telegram",
  "nodes": [
    {
      "parameters": {
        "content": "## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (—É–∂–µ –≤—à–∏—Ç–∞)\n\n‚Ä¢ **Backend API**: http://localhost:3000 (–∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ —Å–≤–æ–π URL)\n‚Ä¢ **Telegram Bot**: —Ç–æ–∫–µ–Ω –≤ —É–∑–ª–µ ¬´Config¬ª\n‚Ä¢ **NewsApi**: –∫–ª—é—á –≤ —É–∑–ª–µ ¬´Config¬ª\n‚Ä¢ Binance / Anthropic ‚Äî –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –≤ .env –±—ç–∫–µ–Ω–¥–∞.",
        "height": 220,
        "width": 380,
        "color": 5
      },
      "id": "sticky-config",
      "name": "–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [-640, -120]
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "backend_url",
              "name": "backendUrl",
              "value": "http://localhost:3000",
              "type": "string"
            },
            {
              "id": "tg_token",
              "name": "telegramBotToken",
              "value": "8558861792:AAECPXLWeRUlgeQcQzo3fLrvkzAbdNyF0dg",
              "type": "string"
            },
            {
              "id": "news_key",
              "name": "newsApiKey",
              "value": "adba7eb9ba2a48ec96afcc63282d2dc0",
              "type": "string"
            }
          ]
        },
        "options": {
          "includeOtherFields": true
        }
      },
      "id": "config-node",
      "name": "Config",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [-420, 120],
      "webhookId": ""
    },
    {
      "parameters": {
        "updates": ["message"],
        "additionalFields": {}
      },
      "id": "telegram-trigger",
      "name": "–°–æ–æ–±—â–µ–Ω–∏–µ –≤ Telegram",
      "type": "n8n-nodes-base.telegramTrigger",
      "typeVersion": 1.1,
      "position": [-640, 320],
      "credentials": {
        "telegramApi": {
          "name": "Telegram Bot BotNot"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict"
          },
          "conditions": [
            {
              "id": "has-text",
              "leftValue": "={{ $json.message?.text }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "notEmpty"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "if-has-text",
      "name": "–ï—Å—Ç—å —Ç–µ–∫—Å—Ç?",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [-420, 320]
    },
    {
      "parameters": {
        "jsCode": "const text = ($input.first().json.message?.text || '').trim().toUpperCase();\nconst match = text.match(/\\/ANALYZE\\s+(\\w+)/i) || [null, text];\nconst symbolRaw = (match[1] || text).toUpperCase();\nconst known = ['ETH', 'BTC', 'SOL', 'BNB', 'XRP', 'DOGE', 'AVAX', 'MATIC', 'LINK', 'DOT', 'ADA', 'APT', 'ARB', 'OP', 'SUI', 'SEI', 'TIA', 'INJ', 'PEPE', 'WIF'];\nconst symbol = known.includes(symbolRaw) ? symbolRaw : (symbolRaw.length <= 6 ? symbolRaw : 'ETH');\nreturn [{ json: { symbol: symbol + '-USDT', symbolRaw, chatId: $input.first().json.message?.chat?.id } }];"
      },
      "id": "extract-symbol",
      "name": "–ò–∑–≤–ª–µ—á—å —Å–∏–º–≤–æ–ª",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [-200, 320]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "={{ $('Config').first().json.backendUrl }}/api/market/analyze/{{ $json.symbol }}",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"timeframe\": \"1m\"\n}",
        "options": {
          "timeout": 60000
        }
      },
      "id": "analyze-1m",
      "name": "–ê–Ω–∞–ª–∏–∑ 1m",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [40, 180],
      "notesInFlow": true,
      "notes": "–ë—ç–∫–µ–Ω–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç BINANCE_API_KEY, ANTHROPIC_API_KEY –∏–∑ .env"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "={{ $('Config').first().json.backendUrl }}/api/market/analyze/{{ $json.symbol }}",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"timeframe\": \"5m\"\n}",
        "options": {
          "timeout": 60000
        }
      },
      "id": "analyze-5m",
      "name": "–ê–Ω–∞–ª–∏–∑ 5m",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [40, 320]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "={{ $('Config').first().json.backendUrl }}/api/market/analyze/{{ $json.symbol }}",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"timeframe\": \"1h\"\n}",
        "options": {
          "timeout": 60000
        }
      },
      "id": "analyze-1h",
      "name": "–ê–Ω–∞–ª–∏–∑ 1h",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [40, 460]
    },
    {
      "parameters": {
        "mode": "append",
        "options": {}
      },
      "id": "merge-analyses",
      "name": "–û–±—ä–µ–¥–∏–Ω–∏—Ç—å 1m/5m/1h",
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3,
      "position": [280, 320]
    },
    {
      "parameters": {
        "jsCode": "const items = $input.all();\nconst config = $('Config').first().json;\nconst chatId = $('–ò–∑–≤–ª–µ—á—å —Å–∏–º–≤–æ–ª').first().json.chatId;\nconst symbol = $('–ò–∑–≤–ª–µ—á—å —Å–∏–º–≤–æ–ª').first().json.symbol;\n\nconst tfOrder = ['1m', '5m', '1h'];\nconst byTf = {};\nfor (const item of items) {\n  const data = item.json;\n  const sig = data.signal || data;\n  const tf = (sig.timeframe || '').toLowerCase() || '?';\n  byTf[tf] = sig;\n}\nconst parts = [];\nlet bestDir = null;\nlet bestConf = 0;\nlet bestRr = 0;\nlet bestEntry = 0;\nlet bestSl = 0;\nlet bestTp = [];\n\nfor (const tf of tfOrder) {\n  const sig = byTf[tf] || byTf['?'] || {};\n  const dir = sig.direction || '‚Äî';\n  const conf = (sig.confidence ?? 0) * 100;\n  const rr = sig.risk_reward ?? 0;\n  const entry = sig.entry_price ?? sig.entryPrice ?? 0;\n  const sl = sig.stop_loss ?? sig.stopLoss ?? 0;\n  const tp = sig.take_profit ?? sig.takeProfit ?? [];\n  if (conf > bestConf) {\n    bestConf = conf;\n    bestDir = dir;\n    bestRr = rr;\n    bestEntry = entry;\n    bestSl = sl;\n    bestTp = Array.isArray(tp) ? tp : [tp];\n  }\n  parts.push(`üìä ${tf}: ${dir} | —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å ${conf.toFixed(0)}% | R:R ${rr.toFixed(2)}`);\n}\n\nconst header = `üîç –ê–Ω–∞–ª–∏–∑ ${symbol} (1m, 5m, 1h)\\n\\n`;\nconst body = parts.join('\\n');\nconst rec = bestDir && bestConf >= 50\n  ? `\\n\\n‚úÖ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –ø–æ —Ñ—å—é—á–µ—Ä—Å–∞–º: ${bestDir}\\n–í—Ö–æ–¥: ${bestEntry.toFixed(4)}\\n–°—Ç–æ–ø: ${bestSl.toFixed(4)}\\n–¢–µ–π–∫-–ø—Ä–æ—Ñ–∏—Ç—ã: ${(bestTp.slice(0, 3).map(t => typeof t === 'number' ? t.toFixed(4) : t)).join(', ')}`\n  : '\\n\\n‚ö†Ô∏è –°–∏–≥–Ω–∞–ª —Å–ª–∞–±—ã–π ‚Äî –¥–æ–∂–¥–∏—Ç–µ—Å—å –ª—É—á—à–µ–π —Ç–æ—á–∫–∏ –≤—Ö–æ–¥–∞.';\n\nconst message = header + body + rec;\n\nreturn [{ json: { message, chatId, symbol, telegramBotToken: config.telegramBotToken } }];"
      },
      "id": "format-signal",
      "name": "–°–≤–æ–¥–∫–∞ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [500, 320]
    },
    {
      "parameters": {
        "url": "https://api.telegram.org/bot{{ $json.telegramBotToken }}/sendMessage",
        "method": "POST",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"chat_id\": {{ $json.chatId }},\n  \"text\": {{ JSON.stringify($json.message) }},\n  \"parse_mode\": \"HTML\",\n  \"disable_web_page_preview\": true\n}",
        "options": {}
      },
      "id": "send-telegram",
      "name": "–û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ Telegram",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [720, 320]
    },
    {
      "parameters": {
        "content": "–ù–∞–ø–∏—à–∏—Ç–µ –±–æ—Ç—É –≤ Telegram:\n‚Ä¢ **ETH** –∏–ª–∏ **BTC** ‚Äî –∞–Ω–∞–ª–∏–∑ –ø–æ —ç—Ç–æ–º—É —Å–∏–º–≤–æ–ª—É\n‚Ä¢ **/analyze SOL** ‚Äî –∞–Ω–∞–ª–∏–∑ SOL\n\n–ë—ç–∫–µ–Ω–¥ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω (npm run dev –≤ backend/).",
        "height": 160,
        "width": 320,
        "color": 6
      },
      "id": "sticky-help",
      "name": "–ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [-640, 520]
    }
  ],
  "connections": {
    "Config": {
      "main": [
        [
          {
            "node": "–ï—Å—Ç—å —Ç–µ–∫—Å—Ç?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–°–æ–æ–±—â–µ–Ω–∏–µ –≤ Telegram": {
      "main": [
        [
          {
            "node": "Config",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ï—Å—Ç—å —Ç–µ–∫—Å—Ç?": {
      "main": [
        [
          {
            "node": "–ò–∑–≤–ª–µ—á—å —Å–∏–º–≤–æ–ª",
            "type": "main",
            "index": 0
          }
        ],
        []
      ]
    },
    "–ò–∑–≤–ª–µ—á—å —Å–∏–º–≤–æ–ª": {
      "main": [
        [
          {
            "node": "–ê–Ω–∞–ª–∏–∑ 1m",
            "type": "main",
            "index": 0
          },
          {
            "node": "–ê–Ω–∞–ª–∏–∑ 5m",
            "type": "main",
            "index": 0
          },
          {
            "node": "–ê–Ω–∞–ª–∏–∑ 1h",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ê–Ω–∞–ª–∏–∑ 1m": {
      "main": [
        [
          {
            "node": "–û–±—ä–µ–¥–∏–Ω–∏—Ç—å 1m/5m/1h",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ê–Ω–∞–ª–∏–∑ 5m": {
      "main": [
        [
          {
            "node": "–û–±—ä–µ–¥–∏–Ω–∏—Ç—å 1m/5m/1h",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "–ê–Ω–∞–ª–∏–∑ 1h": {
      "main": [
        [
          {
            "node": "–û–±—ä–µ–¥–∏–Ω–∏—Ç—å 1m/5m/1h",
            "type": "main",
            "index": 2
          }
        ]
      ]
    },
    "–û–±—ä–µ–¥–∏–Ω–∏—Ç—å 1m/5m/1h": {
      "main": [
        [
          {
            "node": "–°–≤–æ–¥–∫–∞ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–°–≤–æ–¥–∫–∞ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è": {
      "main": [
        [
          {
            "node": "–û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ Telegram",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "tags": [],
  "triggerCount": 1,
  "meta": {
    "templateCredsSetupCompleted": false
  }
}
